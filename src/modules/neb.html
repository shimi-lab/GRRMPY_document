<!DOCTYPE html>
<html class="writer-html5" lang="ja" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NEBモジュール &mdash; GRRMPY 2022/11/10 ドキュメント</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/ase.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="next" title="OPTモジュール" href="opt.html" />
    <link rel="prev" title="Optimizeモジュール" href="optimize.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> GRRMPY
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../basic.html">基本操作</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">インストール</a></li>
<li class="toctree-l1"><a class="reference internal" href="../calculator.html">PFP Calculator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">チュートリアル</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../modules.html">Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="io.html">I/O モジュール</a></li>
<li class="toctree-l2"><a class="reference internal" href="optimize.html">Optimizeモジュール</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">NEBモジュール</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#repetitiveneb">RepetitiveNEB</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#grrmpy.neb.repetitive_neb.RepetitiveNEB"><code class="docutils literal notranslate"><span class="pre">RepetitiveNEB</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#sneb">SNEB</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#grrmpy.neb.auto_neb.SNEB"><code class="docutils literal notranslate"><span class="pre">SNEB</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#aneb">ANEB</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#grrmpy.neb.auto_neb.ANEB"><code class="docutils literal notranslate"><span class="pre">ANEB</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="opt.html">OPTモジュール</a></li>
<li class="toctree-l2"><a class="reference internal" href="automate.html">Automateモジュール</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualize.html">Visualizeモジュール</a></li>
<li class="toctree-l2"><a class="reference internal" href="path.html">Pathモジュール</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.html">Geometryモジュール</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html">Dataモジュール</a></li>
<li class="toctree-l2"><a class="reference internal" href="conv.html">Convモジュール</a></li>
<li class="toctree-l2"><a class="reference internal" href="network.html">Networkモジュール</a></li>
<li class="toctree-l2"><a class="reference internal" href="blender.html">blenderモジュール</a></li>
<li class="toctree-l2"><a class="reference internal" href="commandline.html">コマンドライン</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../blender_gallery.html">Blenderギャラリー</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toy_tools.html">ちょっとした機能</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SearchByPurpose.html">目的から探す</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tips.html">Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithm.html">最短経路アルゴリズム</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other_lib.html">その他のアプリ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other.html">その他</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../SearchByPurpose.html">目的から探す</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">GRRMPY</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../modules.html">Modules</a></li>
      <li class="breadcrumb-item active">NEBモジュール</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/src/modules/neb.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="module-grrmpy.neb.auto_neb">
<span id="neb"></span><h1>NEBモジュール<a class="headerlink" href="#module-grrmpy.neb.auto_neb" title="この見出しへのパーマリンク"></a></h1>
<section id="repetitiveneb">
<h2>RepetitiveNEB<a class="headerlink" href="#repetitiveneb" title="この見出しへのパーマリンク"></a></h2>
<div class="line-block">
<div class="line">(climb=False,mastep=0.05,step=300)→(climb=False,mastep=0.1,step=2000)→(climb=True,mastep=0.25,step=2000)</div>
<div class="line">の条件でNEB計算を行ないたい時は.</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ase.io</span> <span class="kn">import</span> <span class="n">write</span>
<span class="kn">from</span> <span class="nn">grrmpy.neb</span> <span class="kn">import</span> <span class="n">RepetitiveNEB</span>
<span class="kn">from</span> <span class="nn">grrmpy.io</span> <span class="kn">import</span> <span class="n">write_html</span>

<span class="n">rneb</span> <span class="o">=</span> <span class="n">RepetitiveNEB</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
<span class="n">rneb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;NEB.traj&quot;</span><span class="p">,</span><span class="n">rneb</span><span class="o">.</span><span class="n">images</span><span class="p">))</span>
<span class="n">rneb</span><span class="o">.</span><span class="n">attach</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span><span class="n">write_html</span><span class="p">(</span><span class="s2">&quot;NEB_Diagram.traj&quot;</span><span class="p">,</span><span class="n">rneb</span><span class="o">.</span><span class="n">images</span><span class="p">))</span>

<span class="c1"># ある条件でNEB計算がを終えるたびに構造を保存する場合(上書きせず別ファイルへ保存).</span>
<span class="c1"># 3回NEB計算するのでrange(3). それぞれNEB_0.traj,NEB_1.traj,NEB_2.trajに保存される.</span>
<span class="n">rneb</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="k">lambda</span> <span class="n">func</span><span class="p">:</span><span class="nb">iter</span><span class="p">([</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;NEB_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.traj&quot;</span><span class="p">,</span><span class="n">rneb</span><span class="o">.</span><span class="n">images</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]):</span><span class="nb">next</span><span class="p">(</span><span class="n">func</span><span class="p">))</span>

<span class="n">rneb</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
   <span class="n">climb_list</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">],</span>
   <span class="n">maxstep_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.25</span><span class="p">],</span>
   <span class="n">fmax_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">],</span>
   <span class="n">steps_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2000</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="grrmpy.neb.repetitive_neb.RepetitiveNEB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">grrmpy.neb.repetitive_neb.</span></span><span class="sig-name descname"><span class="pre">RepetitiveNEB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints=[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mic=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_func=&lt;function</span> <span class="pre">pfp_calculator&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/grrmpy/neb/repetitive_neb.html#RepetitiveNEB"><span class="viewcode-link"><span class="pre">[ソース]</span></span></a><a class="headerlink" href="#grrmpy.neb.repetitive_neb.RepetitiveNEB" title="この定義へのパーマリンク"></a></dt>
<dd><div class="line-block">
<div class="line">一つのNEBイメージに対して,異なる条件で複数回NEB計算を行なうためのクラス.</div>
<div class="line">デフォルトではclimb,maxsteps,fmax,stepsなど,NEBやOptimizerの引数を変えられる.</div>
</div>
<p>Parameters:</p>
<dl>
<dt>images: list of Atoms</dt><dd><div class="line-block">
<div class="line">Atomsのリスト</div>
</div>
</dd>
<dt>constraints: ASE Constraint</dt><dd><div class="line-block">
<div class="line">constrainオブジェクト,複数制約をかける場合リストで与える.</div>
</div>
</dd>
<dt>parallel: bool</dt><dd><div class="line-block">
<div class="line">並列計算を行なう場合True.</div>
</div>
</dd>
<dt>mic: bool</dt><dd><div class="line-block">
<div class="line">最小イメージ規則にする場合True. デフォルトでは周期境界条件の場合自動でTrueにする.</div>
</div>
</dd>
<dt>calc_func: functions object</dt><dd><div class="line-block">
<div class="line">claculatorを返す関数</div>
</div>
</dd>
<dt>name:</dt><dd><div class="line-block">
<div class="line">指定した名前でlogファイルが作成される.</div>
</div>
</dd>
</dl>
<p>Properties:</p>
<div class="line-block">
<div class="line">RepetitiveNEBのプロパティ(の一部).</div>
<div class="line">このクラスを継承するし, 新たなクラスを作成することでカスタマイズされたNEBを作成することができる.</div>
<div class="line">例えば,updateにイメージを切断,挿入する関数を与えることでSNEBは作成された.</div>
</div>
<dl>
<dt>images: list of Atoms</dt><dd><div class="line-block">
<div class="line">現在実行中のNEBのimages</div>
</div>
</dd>
<dt>neb: NEB</dt><dd><div class="line-block">
<div class="line">現在実行中のneb</div>
</div>
</dd>
<dt>opt: Optimizer</dt><dd><div class="line-block">
<div class="line">現在実行中のOptimizer</div>
</div>
</dd>
<dt>converged: bool</dt><dd><div class="line-block">
<div class="line">直近のNEBの収束状況</div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="grrmpy.neb.repetitive_neb.RepetitiveNEB.attach">
<span class="sig-name descname"><span class="pre">attach</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/grrmpy/neb/repetitive_neb.html#RepetitiveNEB.attach"><span class="viewcode-link"><span class="pre">[ソース]</span></span></a><a class="headerlink" href="#grrmpy.neb.repetitive_neb.RepetitiveNEB.attach" title="この定義へのパーマリンク"></a></dt>
<dd><p>ASEのOptimizerと同じ</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grrmpy.neb.repetitive_neb.RepetitiveNEB.attach_stop">
<span class="sig-name descname"><span class="pre">attach_stop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/grrmpy/neb/repetitive_neb.html#RepetitiveNEB.attach_stop"><span class="viewcode-link"><span class="pre">[ソース]</span></span></a><a class="headerlink" href="#grrmpy.neb.repetitive_neb.RepetitiveNEB.attach_stop" title="この定義へのパーマリンク"></a></dt>
<dd><div class="line-block">
<div class="line">True or Falseを与える関数を設定する</div>
<div class="line">ASEのoptimizerのようにイタレーション毎に与えた関数が実行される.</div>
<div class="line">関数の戻り値がTrueになった場合, 計算が停止する.</div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="grrmpy.neb.repetitive_neb.RepetitiveNEB.default_param">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">default_param</span></span><a class="headerlink" href="#grrmpy.neb.repetitive_neb.RepetitiveNEB.default_param" title="この定義へのパーマリンク"></a></dt>
<dd><p>run()実行時のデフォルトの引数</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grrmpy.neb.repetitive_neb.RepetitiveNEB.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/grrmpy/neb/repetitive_neb.html#RepetitiveNEB.run"><span class="viewcode-link"><span class="pre">[ソース]</span></span></a><a class="headerlink" href="#grrmpy.neb.repetitive_neb.RepetitiveNEB.run" title="この定義へのパーマリンク"></a></dt>
<dd><div class="line-block">
<div class="line">計算を実行する</div>
<div class="line">設定可能な引数がdefault_paramで確認できる.</div>
</div>
<p>Parameters:</p>
<dl>
<dt>base_optimizer: Optimizer</dt><dd><div class="line-block">
<div class="line">NEB計算に使用するOptimizer.</div>
<div class="line">ここで指定したOptimizerを継承して作成されるOptWithCondオプティマイザーが実際には使用される.</div>
</div>
</dd>
<dt>climb_list: list of bool</dt><dd><p>毎回のNEB計算のclib</p>
</dd>
<dt>maxstep_list: list of float</dt><dd><div class="line-block">
<div class="line">毎回のNEB計算のmaxstep_list</div>
<div class="line">要素にNoneを指定した場合,forceに合わせて自動でmaxstepを変化させる.</div>
<div class="line">どのように変化させるかはautomate_maxstep_true,automate_maxstep_falseで指定できる.</div>
</div>
</dd>
<dt>fmax_list: list of float</dt><dd><div class="line-block">
<div class="line">毎回のNEB計算のfmax</div>
</div>
</dd>
<dt>steps_list: list of int</dt><dd><div class="line-block">
<div class="line">毎回のNEB計算のsteps</div>
</div>
</dd>
<dt>neb_kwargs: dict</dt><dd><div class="line-block">
<div class="line">NEBのインスタンス時の引数を指定したい場合に用いる</div>
<div class="line">例えばばね定数kを変えたい場合{&quot;k&quot;=0.2}のようにする</div>
<div class="line">ここで指定した値は全てのNEB計算に適用される</div>
</div>
</dd>
<dt>opt_kwargs: dict</dt><dd><div class="line-block">
<div class="line">Optimizerのインスタンス引数を指定したい場合に用いる.</div>
</div>
</dd>
<dt>automate_maxstep_true: dict</dt><dd><div class="line-block">
<div class="line">climb=True時にautomaxstepを使用した際のmaxstep値</div>
</div>
</dd>
<dt>automate_maxstep_false: dict</dt><dd><div class="line-block">
<div class="line">climb=False時にautomaxstepを使用した際のmaxstep値</div>
</div>
</dd>
<dt>same_energy_and_fmax_arg: dict</dt><dd><div class="line-block">
<div class="line">停止基準</div>
</div>
</dd>
<dt>steep_peak_arg:</dt><dd><div class="line-block">
<div class="line">停止基準</div>
</div>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grrmpy.neb.repetitive_neb.RepetitiveNEB.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">function</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/grrmpy/neb/repetitive_neb.html#RepetitiveNEB.update"><span class="viewcode-link"><span class="pre">[ソース]</span></span></a><a class="headerlink" href="#grrmpy.neb.repetitive_neb.RepetitiveNEB.update" title="この定義へのパーマリンク"></a></dt>
<dd><p>1回のNEB計算が終了する毎に実行される関数を指定できる</p>
</dd></dl>

</dd></dl>

</section>
<section id="sneb">
<h2>SNEB<a class="headerlink" href="#sneb" title="この見出しへのパーマリンク"></a></h2>
<ul>
<li><dl class="simple">
<dt>Step1:</dt><dd><p>緩い収束条件でNEB計算を行ない,最もエネルギーの高い点をTSとする.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>Step2:</dt><dd><div class="line-block">
<div class="line">TS構造の両隣の構造のエネルギーを順次確認し,エネルギーの谷間があった場合,その点をnew_ini,new_fin構造とする(青点).</div>
<div class="line">この時浅い谷間は無視する.具体的にはtolerance kJ/mol以下の谷間は無視する.</div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Step3:</dt><dd><div class="line-block">
<div class="line">TSとnew_ini,TSとfin_iniのエネルギー差をそれぞれ100とした時,threshold以下の点を切り捨てて新たにNEW_INI,NEW_FINを設定する.</div>
<div class="line">(これはTS付近にimageを集中させNEB計算を早く終わらせるために行う.)</div>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Step4:</dt><dd><p>NEW_INIとNEW_FINを新たな始構造,終構造とし,NEB計算を行なう.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Step5:</dt><dd><p>Step1-Step4の操作を繰り返す(デフォルトでは4回行なう)</p>
</dd>
</dl>
</li>
</ul>
<a class="reference internal image-reference" href="../../_images/SNEB.png"><img alt="../../_images/SNEB.png" class="align-center" src="../../_images/SNEB.png" style="width: 760.8000000000001px; height: 452.6px;" /></a>
<div class="admonition important">
<p class="admonition-title">重要</p>
<div class="line-block">
<div class="line">通常のNEB計算とは異なり,計算後のTS構造を <strong>必ずIRC計算する必要がある</strong> ので注意.</div>
<div class="line">引数 <code class="docutils literal notranslate"><span class="pre">html</span></code> を設定すると <strong>NEBのエネルギーダイアグラムを表示できる</strong> が,
この活性化エネルギーはあくまで目安であり,本当の活性化エネルギーはIRCするまで分からない.</div>
<div class="line">通常 <strong>活性化エネルギーは低く見積もられる.</strong></div>
</div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="grrmpy.neb.auto_neb.SNEB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">grrmpy.neb.auto_neb.</span></span><span class="sig-name descname"><span class="pre">SNEB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile='-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">html=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mic=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_func=&lt;function</span> <span class="pre">pfp_calculator&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer=&lt;class</span> <span class="pre">'ase.optimize.fire.FIRE'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_stop=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_n=12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints=[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/grrmpy/neb/auto_neb.html#SNEB"><span class="viewcode-link"><span class="pre">[ソース]</span></span></a><a class="headerlink" href="#grrmpy.neb.auto_neb.SNEB" title="この定義へのパーマリンク"></a></dt>
<dd><p>Parameters:</p>
<dl>
<dt>*data:</dt><dd><div class="line-block">
<div class="line">3種類の方法でinput構造を与えることができる.</div>
<div class="line"><br /></div>
<div class="line">- ini,fin構造と初めの中間イメージの数を与える(3つの引数を与える)</div>
<div class="line">- ini,fin構造を与える(2つの引数を与える.初期イメージの数は13になる)</div>
<div class="line">- images構造を与える(1つの引数を与える.calculatorを付ける必要はない)</div>
<div class="line-block">
<div class="line">imageの数は奇数個を推奨する.</div>
</div>
</div>
<p>Examples:</p>
<blockquote>
<div><p>インスタンス化方法</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sneb</span> <span class="o">=</span> <span class="n">SNEB</span><span class="p">(</span><span class="n">ini</span><span class="p">,</span><span class="n">fin</span><span class="p">,</span><span class="n">html</span><span class="o">=</span><span class="s2">&quot;NEB_progress.html&quot;</span><span class="p">)</span> <span class="c1"># 13個で中間イメージが作られる</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># または</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sneb</span> <span class="o">=</span> <span class="n">SNEB</span><span class="p">(</span><span class="n">ini</span><span class="p">,</span><span class="n">fin</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="n">html</span><span class="o">=</span><span class="s2">&quot;NEB_progress.html&quot;</span><span class="p">)</span> <span class="c1"># 15個で中間イメージが作られる</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># または</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sneb</span> <span class="o">=</span> <span class="n">SNEB</span><span class="p">(</span><span class="n">images</span><span class="p">,</span><span class="n">html</span><span class="o">=</span><span class="s2">&quot;NEB_progress.html&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Constraintsがある場合</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">FixAtoms</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sneb</span> <span class="o">=</span> <span class="n">SNEB</span><span class="p">(</span><span class="n">ini</span><span class="p">,</span><span class="n">fin</span><span class="p">,</span><span class="n">html</span><span class="o">=</span><span class="s2">&quot;NEB_progress.html&quot;</span><span class="p">,</span><span class="n">constraints</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">FixAtoms</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">FixBondLength</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sneb</span> <span class="o">=</span> <span class="n">SNEB</span><span class="p">(</span><span class="n">ini</span><span class="p">,</span><span class="n">fin</span><span class="p">,</span><span class="n">html</span><span class="o">=</span><span class="s2">&quot;NEB_progress.html&quot;</span><span class="p">,</span><span class="n">constraints</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="p">,</span><span class="n">c</span><span class="p">])</span>
</pre></div>
</div>
</div></blockquote>
</dd>
<dt>logfile: str or Path</dt><dd><p>logファイルを出力する場合,ファイル名.</p>
</dd>
<dt>html: str or Path</dt><dd><p>途中のNEBイメージを保存する場合にファイル名を設定.</p>
</dd>
<dt>mic<span class="classifier">bool</span></dt><dd><p>周期境界条件の際, 最小距離でイメージを作成する場合.True.
設定しない場合(None). ini構造が周期境界条件である場合.自動的にTrueにする.</p>
</dd>
<dt>parallel: bool</dt><dd><p>並行処理を行なう場合.True. デフォルトはTrue.</p>
</dd>
<dt>calc_func: object</dt><dd><p>calculatorを返す関数.デフォルトはpfpのcalculator</p>
</dd>
<dt>optimizer: class</dt><dd><p>NEB計算を行なう際のOptimizer. デフォルトはFIRE.</p>
</dd>
<dt>with_stop: bool</dt><dd><div class="line-block">
<div class="line">optimizerにstop機能を付ける場合True.</div>
<div class="line">max_n回連続でEnergyとForceが同じ状況がtimes回あった時計算を終了する.</div>
<div class="line">grrmpy.optimize.functions.add_stop_to()を参照</div>
</div>
</dd>
<dt>max_n: int:</dt><dd><p>with_stop=Trueの場合に指定.
with_stop(add_stop_to)の引数. デフォルト12</p>
</dd>
<dt>times: int</dt><dd><p>with_stop=Trueの場合に指定.
with_stop(add_stop_to)の引数. デフォルト2</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">注釈</p>
<p>*data以外の引数は全てキーワード引数になるので注意!!</p>
</div>
<p>Propertes:</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="grrmpy.neb.auto_neb.SNEB.archive">
<span class="sig-name descname"><span class="pre">archive</span></span><a class="headerlink" href="#grrmpy.neb.auto_neb.SNEB.archive" title="この定義へのパーマリンク"></a></dt>
<dd><p>全てのNEBイメージが2次元リストで保存されている</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grrmpy.neb.auto_neb.SNEB.images">
<span class="sig-name descname"><span class="pre">images</span></span><a class="headerlink" href="#grrmpy.neb.auto_neb.SNEB.images" title="この定義へのパーマリンク"></a></dt>
<dd><p>現在のNEBイメージ</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="grrmpy.neb.auto_neb.SNEB.imax">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">imax</span></span><a class="headerlink" href="#grrmpy.neb.auto_neb.SNEB.imax" title="この定義へのパーマリンク"></a></dt>
<dd><p>NEB計算上でTSと判断されたindex番号</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grrmpy.neb.auto_neb.SNEB.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[13,</span> <span class="pre">9,</span> <span class="pre">12]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxstep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.2,</span> <span class="pre">0.2,</span> <span class="pre">0.1,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.12,</span> <span class="pre">0.1,</span> <span class="pre">0.07,</span> <span class="pre">0.05]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[500,</span> <span class="pre">1000,</span> <span class="pre">1000,</span> <span class="pre">2000]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[30,</span> <span class="pre">20,</span> <span class="pre">20]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_nimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">climb_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">climb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/grrmpy/neb/auto_neb.html#SNEB.run"><span class="viewcode-link"><span class="pre">[ソース]</span></span></a><a class="headerlink" href="#grrmpy.neb.auto_neb.SNEB.run" title="この定義へのパーマリンク"></a></dt>
<dd><p>Parameters:</p>
<dl>
<dt>nimages: list of integers</dt><dd><p>毎回のNEB計算のイメージの数, 5以上の奇数.</p>
</dd>
<dt>maxstep: list of float</dt><dd><p>毎回のNEB計算のmaxstep値,Noneを要素にとった場合,fmaxに応じて自動調整する.</p>
</dd>
<dt>fmax: list of float</dt><dd><p>毎回のNEB計算のfmax値</p>
</dd>
<dt>steps: list of integers</dt><dd><p>毎回のNEB計算のsteps値</p>
</dd>
<dt>tolerance: float</dt><dd><p>tolerance(kJ/mol)以下の谷間は無視する.デフォルトは5 kJ/mol</p>
</dd>
<dt>threshold: list of float</dt><dd><p>山の高さのthreshold%以下の点は切り捨てる.デフォルトは30%</p>
</dd>
<dt>dist: float</dt><dd><div class="line-block">
<div class="line">新たなNEBイメージを作成する際に,TS付近に2つイメージを作成する.</div>
<div class="line">TS構造からの変位をdistで設定する</div>
</div>
</dd>
<dt>min_nimages: integer</dt><dd><div class="line-block">
<div class="line">NEBバンドを切断する際,最低min_nimages個の点を残す.デフォルトは3</div>
<div class="line">(一個だけ突出しているTS(Wみたいな形)のNEBバンドがあった時のために設定する)</div>
</div>
</dd>
<dt>climb_steps: integer</dt><dd><div class="line-block">
<div class="line">climb=Falseで収束しなかった場合,その後のTrueでのNEB計算のStep数をclimb_steps回にする.</div>
<div class="line">Noneの場合,climb=Falseの時と同じstepsで計算する.</div>
<div class="line">一番最後のNEB計算ではclimb_stepsに関係なくclimb=Falseの時と同じstepsで計算する.</div>
</div>
</dd>
<dt>climb: bool</dt><dd><div class="line-block">
<div class="line">Falseの場合,climbはFalse,False,False,False...Trueで行なう.</div>
<div class="line">Trueの場合はclimbはFalse,True,Fase,True,False....Trueで行なう</div>
<div class="line">Falseにした場合,climb_stepsを設定する意味はなくなる.</div>
</div>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="aneb">
<h2>ANEB<a class="headerlink" href="#aneb" title="この見出しへのパーマリンク"></a></h2>
<p>TSから <code class="docutils literal notranslate"><span class="pre">nsampling</span></code> 離れた点を新たな始構造,終構造(new_ini,new_fin)としてNEB計算を行なう.</p>
<a class="reference internal image-reference" href="../../_images/ANEB.png"><img alt="../../_images/ANEB.png" class="align-center" src="../../_images/ANEB.png" style="width: 749.0px; height: 437.20000000000005px;" /></a>
<dl class="py class">
<dt class="sig sig-object py" id="grrmpy.neb.auto_neb.ANEB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">grrmpy.neb.auto_neb.</span></span><span class="sig-name descname"><span class="pre">ANEB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile='-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">html=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mic=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallel=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_func=&lt;function</span> <span class="pre">pfp_calculator&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer=&lt;class</span> <span class="pre">'ase.optimize.fire.FIRE'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_stop=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_n=12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">times=2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraints=[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/grrmpy/neb/auto_neb.html#ANEB"><span class="viewcode-link"><span class="pre">[ソース]</span></span></a><a class="headerlink" href="#grrmpy.neb.auto_neb.ANEB" title="この定義へのパーマリンク"></a></dt>
<dd><p>Propertes:</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="grrmpy.neb.auto_neb.ANEB.archive">
<span class="sig-name descname"><span class="pre">archive</span></span><a class="headerlink" href="#grrmpy.neb.auto_neb.ANEB.archive" title="この定義へのパーマリンク"></a></dt>
<dd><p>全てのNEBイメージが2次元リストで保存されている</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="grrmpy.neb.auto_neb.ANEB.images">
<span class="sig-name descname"><span class="pre">images</span></span><a class="headerlink" href="#grrmpy.neb.auto_neb.ANEB.images" title="この定義へのパーマリンク"></a></dt>
<dd><p>現在のNEBイメージ</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="grrmpy.neb.auto_neb.ANEB.imax">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">imax</span></span><a class="headerlink" href="#grrmpy.neb.auto_neb.ANEB.imax" title="この定義へのパーマリンク"></a></dt>
<dd><p>NEB計算上でTSと判断されたindex番号</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="grrmpy.neb.auto_neb.ANEB.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.12,</span> <span class="pre">0.1,</span> <span class="pre">0.07,</span> <span class="pre">0.05]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[500,</span> <span class="pre">1000,</span> <span class="pre">1000,</span> <span class="pre">2000]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxstep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.2,</span> <span class="pre">0.2,</span> <span class="pre">0.1,</span> <span class="pre">None]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[13,</span> <span class="pre">9,</span> <span class="pre">12]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[3,</span> <span class="pre">3,</span> <span class="pre">3]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/grrmpy/neb/auto_neb.html#ANEB.run"><span class="viewcode-link"><span class="pre">[ソース]</span></span></a><a class="headerlink" href="#grrmpy.neb.auto_neb.ANEB.run" title="この定義へのパーマリンク"></a></dt>
<dd><div class="line-block">
<div class="line">ini,fin構造の間に3つのイメージを作成し,緩い収束条件でNEB計算を行なう.</div>
<div class="line">計算後のTS構造の両隣の構造を新たなini,fin構造としてNEB計算を行なう.</div>
<div class="line">この操作を合計len(nimages)回繰り返す(NEB計算をlen(nimages)回行なう).</div>
<div class="line">最後のNEB計算のみ収束条件を厳しく(=fmax)する.</div>
<div class="line">デフォルトではn=4回のNEB計算を行なう.</div>
</div>
<p>Parameters:</p>
<dl>
<dt>fmax: float or list of float</dt><dd><div class="line-block">
<div class="line">floatで与えた場合,[fmax*2,fmax*2,fmax*2,...fmax]の収束条件で計算する.</div>
<div class="line">(最後だけ厳しい収束条件で計算する)</div>
<div class="line">listで与えた場合, [fmax_0, fmax_1, fmax_2,...fmax_n]の収束条件で計算する.</div>
</div>
</dd>
<dt>steps: integers or list of integers</dt><dd><div class="line-block">
<div class="line">integersで与えた場合,[steps,steps,steps,...steps*5]のステップ数で計算する.</div>
<div class="line">listで与えた場合, [steps_0, steps_1, steps_2,...steps_n]のステップ数で計算する.</div>
</div>
</dd>
<dt>maxstep: float or list of float</dt><dd><div class="line-block">
<div class="line">maxstep. Noneの場合,Forceに合わせて自動的に調整する.</div>
<div class="line">詳しくはgrrmpy.optimize.attach.automate_maxsteps()を参照</div>
<div class="line">floatで与えた場合,maxstepの値で計算する.</div>
<div class="line">listで与えた場合, [maxstep_0, maxstep_1, maxstep_2,...maxstep_n]の収束条件で計算する.</div>
<div class="line">None,またはNoneの要素を与えた場合,forceに合わせて自動的に調整する.</div>
</div>
</dd>
<dt>nimages: list of integers</dt><dd><div class="line-block">
<div class="line">毎回のNEB計算の中間イメージ数.</div>
<div class="line">[nimages_0, nimages_1, nimages_2,...nimages_n]イメージ数で作成する.</div>
</div>
</dd>
<dt>nsampling: integers or list of integers</dt><dd><div class="line-block">
<div class="line">TS構造からforward側,reverse側にそれぞれnsampling個隣の構造を</div>
<div class="line">新たなini,fin構造としてイメージを作成する.</div>
<div class="line">integersで与えた場合,nsamplingのイメージ数で作成する.</div>
<div class="line">listで与えた場合, [nsampling_0, nsampling_1, nsampling_2,...nsampling_n]イメージ数で作成する.</div>
<div class="line">Noneの場合,自動的に調整する.</div>
</div>
</dd>
<dt>dist: float</dt><dd><div class="line-block">
<div class="line">新たなNEBイメージを作成する際に,TS付近に2つイメージを作成する.</div>
<div class="line">TS構造からの変位をdistで設定する</div>
</div>
</dd>
<dt>Retrun:</dt><dd><p>bool: 収束した場合True.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="optimize.html" class="btn btn-neutral float-left" title="Optimizeモジュール" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="opt.html" class="btn btn-neutral float-right" title="OPTモジュール" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Kato Taisetsu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>